import{r as a,e as Q,V as D,j as e,g,m as U,U as O,P as W,i as P}from"./index-CZ0aMDF1.js";import{D as $}from"./download-D0wQykv5.js";import{D as u}from"./dollar-sign-BszbyJVU.js";import{R as q}from"./receipt-C0AtCWaE.js";import{S as _}from"./search-DZxNIAtT.js";import{E as H}from"./eye-CfzNov6g.js";const se=()=>{var w,v,k,S;const[T,F]=a.useState([]),[I,y]=a.useState(!1),[n,L]=a.useState(""),[x,M]=a.useState("all"),[m,E]=a.useState("all"),[o,V]=a.useState("7d"),[t,p]=a.useState(null),[z,j]=a.useState(!1);a.useEffect(()=>{N()},[o]);const N=async()=>{try{y(!0);const s=await Q.get("/transactions",{params:{dateRange:o}});s.data.success&&F(s.data.data||[])}catch(s){console.error("Failed to load transactions:",s),D.error("Failed to load transactions")}finally{y(!1)}},G=s=>{p(s),j(!0)},B=s=>{switch(s){case"cash":return e.jsx(u,{className:"w-4 h-4"});case"card":return e.jsx(P,{className:"w-4 h-4"});case"upi":return e.jsx(P,{className:"w-4 h-4"});default:return e.jsx(u,{className:"w-4 h-4"})}},f=s=>{switch(s){case"Completed":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"Pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"Failed":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},c=T.filter(s=>{var i,C,A,R;const r=((i=s.billNumber)==null?void 0:i.toLowerCase().includes(n.toLowerCase()))||((A=(C=s.customerInfo)==null?void 0:C.name)==null?void 0:A.toLowerCase().includes(n.toLowerCase()))||((R=s.cashierName)==null?void 0:R.toLowerCase().includes(n.toLowerCase())),l=x==="all"||s.paymentStatus===x,d=m==="all"||s.paymentMethod===m;return r&&l&&d}),b=c.reduce((s,r)=>s+(r.finalAmount||0),0),h=c.length;return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center",children:[e.jsx(g,{className:"w-8 h-8 mr-3 text-blue-600"}),"Bill Management"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"View and manage all generated bills"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:N,className:"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 px-4 py-2 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 flex items-center",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Refresh"]}),e.jsxs("button",{onClick:()=>D.info("Export feature coming soon"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Export"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900 rounded-lg",children:e.jsx(g,{className:"w-6 h-6 text-blue-600 dark:text-blue-300"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Transactions"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:h})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900 rounded-lg",children:e.jsx(u,{className:"w-6 h-6 text-green-600 dark:text-green-300"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["Rs.",b.toLocaleString()]})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900 rounded-lg",children:e.jsx(q,{className:"w-6 h-6 text-purple-600 dark:text-purple-300"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Average Order"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["Rs.",h>0?(b/h).toFixed(0):0]})]})]})})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Search transactions...",className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",value:n,onChange:s=>L(s.target.value)})]}),e.jsxs("select",{className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",value:x,onChange:s=>M(s.target.value),children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"Completed",children:"Completed"}),e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Failed",children:"Failed"})]}),e.jsxs("select",{className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",value:m,onChange:s=>E(s.target.value),children:[e.jsx("option",{value:"all",children:"All Payment Methods"}),e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"card",children:"Card"}),e.jsx("option",{value:"upi",children:"UPI"})]}),e.jsxs("select",{className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",value:o,onChange:s=>V(s.target.value),children:[e.jsx("option",{value:"1d",children:"Today"}),e.jsx("option",{value:"7d",children:"Last 7 Days"}),e.jsx("option",{value:"30d",children:"Last 30 Days"}),e.jsx("option",{value:"90d",children:"Last 90 Days"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Transaction"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Customer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Items"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Payment"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:I?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-8 text-center",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mr-2"}),"Loading transactions..."]})})}):c.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:7,className:"px-6 py-8 text-center",children:[e.jsx(g,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No transactions found"})]})}):c.map(s=>{var r,l,d,i;return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:s.billNumber||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:new Date(s.billGeneratedAt||s.createdAt).toLocaleString()}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Cashier: ",s.cashierName||"N/A"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{className:"w-4 h-4 mr-2 text-gray-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:((r=s.customerInfo)==null?void 0:r.name)||"Walk-in Customer"}),((l=s.customerInfo)==null?void 0:l.phone)&&e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.customerInfo.phone})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(W,{className:"w-4 h-4 mr-2 text-gray-400"}),e.jsxs("span",{className:"text-sm text-gray-900 dark:text-white",children:[((d=s.items)==null?void 0:d.length)||0," items"]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["Rs.",(s.finalAmount||0).toFixed(2)]}),s.gstAmount>0&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(GST: Rs.",((i=s.gstAmount)==null?void 0:i.toFixed(2))||0,")"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[B(s.paymentMethod),e.jsx("span",{className:"ml-2 text-sm text-gray-900 dark:text-white capitalize",children:s.paymentMethod||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${f(s.paymentStatus)}`,children:s.paymentStatus||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("button",{onClick:()=>G(s),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 flex items-center",children:[e.jsx(H,{className:"w-4 h-4 mr-1"}),"View"]})})]},s._id)})})]})})}),z&&t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:["Transaction Details - ",t.billNumber]}),e.jsx("button",{onClick:()=>{j(!1),p(null)},className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:"âœ•"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:"Transaction Info"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Bill Number:"}),e.jsx("span",{className:"font-medium",children:t.billNumber})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Date:"}),e.jsx("span",{className:"font-medium",children:new Date(t.billGeneratedAt||t.createdAt).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Cashier:"}),e.jsx("span",{className:"font-medium",children:t.cashierName||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Payment Method:"}),e.jsx("span",{className:"font-medium capitalize",children:t.paymentMethod})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${f(t.paymentStatus)}`,children:t.paymentStatus})]})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:"Customer Info"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Name:"}),e.jsx("span",{className:"font-medium",children:((w=t.customerInfo)==null?void 0:w.name)||"Walk-in Customer"})]}),((v=t.customerInfo)==null?void 0:v.email)&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Email:"}),e.jsx("span",{className:"font-medium",children:t.customerInfo.email})]}),((k=t.customerInfo)==null?void 0:k.phone)&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Phone:"}),e.jsx("span",{className:"font-medium",children:t.customerInfo.phone})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:"Items"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Product"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Qty"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Price"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Total"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:(S=t.items)==null?void 0:S.map((s,r)=>{var l,d;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:s.productName}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:s.barcode})]})}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-white",children:s.quantity}),e.jsxs("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-white",children:["Rs.",(l=s.unitPrice)==null?void 0:l.toFixed(2)]}),e.jsxs("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-white",children:["Rs.",(d=s.totalPrice)==null?void 0:d.toFixed(2)]})]},r)})})]})})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:"Order Summary"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Subtotal:"}),e.jsxs("span",{className:"font-medium",children:["Rs.",(t.subtotal||0).toFixed(2)]})]}),t.totalDiscount>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Discount:"}),e.jsxs("span",{className:"font-medium text-green-600",children:["-Rs.",t.totalDiscount.toFixed(2)]})]}),t.gstAmount>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"GST (18%):"}),e.jsxs("span",{className:"font-medium",children:["Rs.",t.gstAmount.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Total:"}),e.jsxs("span",{className:"text-gray-900 dark:text-white",children:["Rs.",(t.finalAmount||0).toFixed(2)]})]})]})]})]})})]})};export{se as default};
