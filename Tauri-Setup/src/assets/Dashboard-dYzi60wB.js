import{c as M,u as U,r as x,f as g,V as B,g as D,P as h,A as P,j as e,C as E,T as F,L as c,h as G,B as R,R as Q,i as z,k as H}from"./index-CZ0aMDF1.js";import{D as W}from"./dollar-sign-BszbyJVU.js";import{U as u}from"./users-DChjM-yE.js";import{T as Y,A as d}from"./trending-down-BHNdoN6M.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=M("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),se=()=>{var y,v,j,N,f,w,k,A,S,_,T,C;const{user:o,hasPermission:l}=U(),[p,b]=x.useState(!0),[t,I]=x.useState({stats:{todayRevenue:0,todayOrders:0,totalCustomers:0,totalProducts:0,lowStockItems:0,outOfStockItems:0},recentActivity:[],quickActions:[]});x.useEffect(()=>{O()},[]);const O=async()=>{try{b(!0);const s=[];l("view_dashboard")&&(s.push(g.admin.getStats({period:"1d"})),s.push(g.revenue.getTodayRevenue())),l("view_reports")&&s.push(g.admin.getRecentActivity({limit:5}));const a=await Promise.allSettled(s),r=a[0],i=a[1],n=a[2],$=(r==null?void 0:r.status)==="fulfilled"?r.value.data:{},m=(i==null?void 0:i.status)==="fulfilled"?i.value.data:{};I({stats:{...$,totalRevenue:m.totalRevenue||0,totalTransactions:m.totalTransactions||0,averageOrderValue:m.averageOrderValue||0},recentActivity:(n==null?void 0:n.status)==="fulfilled"?n.value.data:[],quickActions:q()})}catch(s){console.error("Failed to load dashboard data:",s),B.error("Failed to load dashboard data")}finally{b(!1)}},q=()=>{const s=[];return l("process_bills")&&s.push({name:"POS Terminal",description:"Process new sale",href:"/pos",icon:z,color:"bg-green-500"}),l("manage_inventory")&&s.push({name:"Inventory",description:"Manage stock",href:"/inventory",icon:H,color:"bg-blue-500"}),l("manage_products")&&s.push({name:"Products",description:"Add/edit products",href:"/products",icon:h,color:"bg-purple-500"}),l("manage_customers")&&s.push({name:"Customers",description:"Manage customers",href:"/customers",icon:u,color:"bg-orange-500"}),s},V=[{title:"Total Revenue",value:`Rs.${(((y=t.stats)==null?void 0:y.totalRevenue)||0).toLocaleString()}`,icon:W,color:"bg-green-500",change:null,permission:"view_dashboard"},{title:"Total Orders",value:(((v=t.stats)==null?void 0:v.totalOrders)||0).toString(),icon:D,color:"bg-blue-500",change:null,permission:"view_dashboard"},{title:"Total Customers",value:(((j=t.stats)==null?void 0:j.totalCustomers)||0).toLocaleString(),icon:u,color:"bg-purple-500",change:null,permission:"manage_customers"},{title:"Total Products",value:(((N=t.stats)==null?void 0:N.totalProducts)||0).toLocaleString(),icon:h,color:"bg-indigo-500",change:null,permission:"manage_products"},{title:"Low Stock Items",value:(((f=t.stats)==null?void 0:f.lowStockItems)||0).toString(),icon:P,color:"bg-orange-500",change:null,permission:"manage_inventory"},{title:"Out of Stock",value:(((w=t.stats)==null?void 0:w.outOfStockItems)||0).toString(),icon:P,color:"bg-red-500",change:null,permission:"manage_inventory"}].filter(s=>!s.permission||l(s.permission));return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:["Welcome back, ",((k=o==null?void 0:o.fullName)==null?void 0:k.split(" ")[0])||((A=o==null?void 0:o.name)==null?void 0:A.split(" ")[0])||"User","! ðŸ‘‹"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Here's what's happening with your store today."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8",children:p?e.jsx(E,{count:4}):V.map((s,a)=>{const r=s.icon;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 hover:shadow-xl transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:`${s.color} p-3 rounded-xl`,children:e.jsx(r,{className:"w-6 h-6 text-white"})}),s.change!==null&&e.jsxs("div",{className:`flex items-center ${s.change>=0?"text-green-600":"text-red-600"}`,children:[s.change>=0?e.jsx(F,{className:"w-4 h-4 mr-1"}):e.jsx(Y,{className:"w-4 h-4 mr-1"}),e.jsxs("span",{className:"text-sm font-medium",children:[Math.abs(s.change).toFixed(1),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:s.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.value})]})]},a)})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-6 flex items-center",children:[e.jsx(d,{className:"w-5 h-5 mr-2"}),"Quick Actions"]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:(S=t.quickActions)==null?void 0:S.map((s,a)=>{const r=s.icon;return e.jsx(c,{to:s.href,className:"group p-4 border-2 border-gray-200 dark:border-gray-700 rounded-xl hover:border-blue-500 dark:hover:border-blue-400 transition-colors",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`${s.color} p-2 rounded-lg group-hover:scale-110 transition-transform`,children:e.jsx(r,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.description})]}),e.jsx(L,{className:"w-4 h-4 text-gray-400 group-hover:text-blue-500 group-hover:translate-x-1 transition-all"})]})},a)})}),((_=t.quickActions)==null?void 0:_.length)===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(d,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No quick actions available based on your permissions"})]})]}),e.jsx(G,{permission:"view_reports",fallback:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(R,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"You don't have permission to view recent activity"})]})}),children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center",children:[e.jsx(R,{className:"w-5 h-5 mr-2"}),"Recent Activity"]}),e.jsxs(c,{to:"/admin",className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-sm font-medium flex items-center",children:["View All",e.jsx(L,{className:"w-4 h-4 ml-1"})]})]}),p?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((s,a)=>e.jsxs("div",{className:"flex items-center space-x-3 animate-pulse",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})]})]},a))}):((T=t.recentActivity)==null?void 0:T.length)>0?e.jsx("div",{className:"space-y-4",children:(C=t.recentActivity)==null?void 0:C.map((s,a)=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:`p-2 rounded-full ${s.type==="sale"?"bg-green-100 text-green-600":s.type==="inventory"?"bg-blue-100 text-blue-600":s.type==="user"?"bg-purple-100 text-purple-600":"bg-gray-100 text-gray-600"}`,children:[s.type==="sale"&&e.jsx(D,{className:"w-4 h-4"}),s.type==="inventory"&&e.jsx(h,{className:"w-4 h-4"}),s.type==="user"&&e.jsx(u,{className:"w-4 h-4"}),s.type==="system"&&e.jsx(d,{className:"w-4 h-4"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:s.description}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[s.user," â€¢ ",new Date(s.timestamp).toLocaleTimeString()]})]})]},a))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(d,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No recent activity to display"})]})]})})]}),e.jsx(Q,{roles:["super_admin","store_admin"],children:e.jsxs("div",{className:"mt-8 bg-blue-50 dark:bg-blue-900/20 rounded-2xl p-6 border border-blue-200 dark:border-blue-800",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 dark:text-blue-200 mb-2",children:"Admin Tools"}),e.jsx("p",{className:"text-blue-700 dark:text-blue-300 mb-4",children:"Access advanced analytics and system management tools."}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(c,{to:"/admin",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Admin Dashboard"}),e.jsx(c,{to:"/settings/store",className:"bg-white text-blue-600 px-4 py-2 rounded-lg border border-blue-300 hover:bg-blue-50 transition-colors",children:"Store Settings"})]})]})})]})};export{se as default};
